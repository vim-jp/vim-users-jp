---
layout: post
category: vimusersjp
title: Hack #190:#58; テキストを折り畳む &#8211; 表示編
date: 2010-12-22
author: thinca
---
<p>fold 機能によって折り畳まれた部分の表示は、カスタマイズすることができます。</p>

<h3><code class="option">'foldtext'</code> オプション</h3>

<p>折り畳まれた行に表示されるテキストを、<code class="option">'foldtext'</code> でカスタマイズすることができます。これは <code class="option">'foldexpr'</code> のように、表示するテキストを生成する式を指定します。式の中では以下の変数を参照できます。</p>

<table>
<thead>
<tr>
<th>変数</th>
<th>意味</th>
</tr>
</thead>
<tbody>
<tr>
<td>v:foldstart</td>
<td>折り畳みの先頭の行番号。</td>
</tr>
<tr>
<td>v:foldend</td>
<td>折り畳みの末尾の行番号。</td>
</tr>
<tr>
<td>v:foldlevel</td>
<td>折り畳みレベル。</td>
</tr>
<tr>
<td>v:folddashes</td>
<td>repeat(&#8220;-&#8221;, v:foldlevel) と同じもの。</td>
</tr>
</tbody>
</table>

<p>例えば、<a href="http://vim-users.jp/2010/12/hack186/">Hack #186: テキストを折り畳む &#8211; 自作編</a> で紹介した help の折り畳みは、&#8221;=&#8221; の連続した行が先頭になるため、折り畳むと &#8220;=&#8221; だけが表示されてしまい中身がよくわかりません。
以下のように設定することで次の行が表示されるようになり、少しわかりやすくなります。</p>

<pre><code>setlocal foldtext=getline(v:foldstart+1)
</code></pre>

<p>もちろん、関数を作成してもっと凝った設定を行うことで折り畳みレベルや折り畳まれた行数などの情報を表示することも可能です。</p>

<address class="hack-author">thinca</address>
